---
title: "Course Assignment"
author: "Moritz KÃ¶rber"
date: "15 Juli 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

First step: Load required packages:

```{r message=FALSE, warning=FALSE}
library("dplyr")
library("caret")
library("mlr")
library("visdat")
```

Load data and set seed:

```{r}
df <- read.csv("1_data/pml-training.csv", na.strings = c("NA", "NaN", "", "#DIV/0!"), row.names = 1)

set.seed(31)
```


# 1. Inspect target variable
First, I am looking at the target variable "classe":

```{r echo=FALSE}
# What is "classe"?
glimpse(df$classe)
```

Since it is a categorical variable, it is a classification problem. Hence, an algorithm like logistic regression, random forests, or knn is suitable. 

# 2. Inspect predictors
Remove obvious non-predictive variables

```{r crop predictors without any information, echo=T}
df %>% select(-c(raw_timestamp_part_1, raw_timestamp_part_2, cvtd_timestamp)) -> df
```

Remove zero variance/near zero variance predictors
```{r}
nzv <- nearZeroVar(df)
df <- df[-nzv]

df <- removeConstantFeatures(df, perc = .02)
```

Remove predictors with mostly NAs:
```{r Show predictors with much information}
df %>%
  select(everything()) %>%
  summarise_all(funs(sum(is.na(.)) / length(.))) -> p

# check these variables
vis_miss(df[which(p > 0.975)],
  sort_miss = TRUE, warn_large_data = F
)

# remove them if sensible
df[which(p > 0.975)] <- NULL
```